<div *ngFor="let event of filteredEvents" class="event-details">
	<div *ngIf="!updateMode">
		<h2>{{ event.title }}</h2>
		<p>Description: {{ event.description }}</p>
		<p>Poll Close Date: {{ event.pollCloseDate | date : 'medium' }}</p>
		<p>Votes:</p>
		<div *ngFor="let result of event.pollResults">
			<p>Key: {{ result.dateTime }}</p>
			<ul>
				<li>Yes: {{ result.yesCount }}</li>
				<li>No: {{ result.noCount }}</li>
				<li>Maybe: {{ result.maybeCount }}</li>
			</ul>
		</div>
		<p>
			Location: {{ event.location.street }}, {{ event.location.zipCode }}
			{{ event.location.city }}, {{ event.location.state }}
		</p>
		<p>Invitations:</p>
		<ul>
			<li *ngFor="let invitation of event.invitations">
				{{ invitation.email }}
			</li>
		</ul>
		<div class="button-container">
			<button (click)="toggleUpdateMode()" class="edit-button">Change</button>
			<button (click)="deleteEvent()" class="delete-button">Delete</button>
			<button (click)="goBack()" class="back-button">Zur√ºck</button>
			<button
				(click)="downloadIcsFile(event.icsFileData)"
				class="calendar-button"
			>
				In den Kalender eintragen
			</button>
		</div>
	</div>

	<div *ngIf="updateMode" class="update-form">
		<form [formGroup]="createForm2">
			<label for="title">Title:</label>
			<input type="text" id="title" formControlName="title" />

			<label for="description">Description:</label>
			<textarea id="description" formControlName="description"></textarea>

			<label for="street">Street:</label>
			<input type="text" id="street" formControlName="street" />

			<label for="city">City:</label>
			<input type="text" id="city" formControlName="city" />

			<label for="state">State:</label>
			<input type="text" id="state" formControlName="state" />

			<label for="zipCode">Zip Code:</label>
			<input type="text" id="zipCode" formControlName="zipCode" />

			<label for="deadlineDate">Poll Close Date:</label>
			<input type="date" id="deadlineDate" formControlName="deadlineDate" />
			<input type="time" id="deadlineTime" formControlName="deadlineTime" />

			<div formArrayName="timePoints">
				<div
					*ngFor="let timePoint of getTimePointsArray(); let i = index"
					[formGroupName]="i"
				>
					<label for="date">Poll Option Date:</label>
					<input type="date" formControlName="date" />
					<label for="time">Poll Option Time:</label>
					<input type="time" formControlName="time" />
				</div>
			</div>

			<div formArrayName="invitations">
				<div
					*ngFor="let invitation of getInvitationsArray(); let i = index"
					[formGroupName]="i"
				>
					<label for="email">Invitation Email:</label>
					<input type="email" formControlName="email" />
					<button type="button" (click)="removeInvitation(i)">Remove</button>
				</div>
			</div>
			<button type="button" (click)="addInvitation()">Add Invitation</button>

			<div class="button-container">
				<button type="button" (click)="updateEvent()" class="save-button">
					Save
				</button>
				<button
					type="button"
					(click)="toggleUpdateMode()"
					class="cancel-button"
				>
					Cancel
				</button>
			</div>
		</form>
	</div>
</div>
